# Event pipeline

The goal is to create an execution path where a node is invoked after a parent node has processed an event.

The [@OnEvent](https://github.com/v12technology/fluxtion/blob/master/builder/src/main/java/com/fluxtion/api/annotations/OnEvent.java)  annotation marks a method to be included in the execution graph. The method will be invoked when all of its dependent nodes on the execution path have processed the event. Event processing includes `@OnEvent` and `@EventHandler` methods.

A no argument method is required with an optional boolean return. The boolean return indicates whether this node is "dirty" and changed its state. 

Example below defines PipelineNode dependent upon a DataEventHandler, that processes DataEvent's.

```java
public class PipelineNode {

    private final DataEventHandler handler;

    public PipelineNode(DataEventHandler handler) {
        this.handler = handler;
    }
    
    @OnEvent
    public void update(){
    }
}
```

The update method will be invoked by the SEP in topological order after the DataHandler has processed an incoming event. We define the graph using this builder class imperatively, further discussion on builders is in the [graph building](../graph-building-primitives.md) section.

```java
public class Builder extends SEPConfig {

    @Override
    public void buildConfig() {
        DataEventHandler handler = new DataEventHandler();
        PipelineNode node = new PipelineNode(handler);
        addNode(handler);
        addNode(node);
    }

}
```

The generated SEP, implements a dispatch method invoking the execution path in topological order

```java
  public SampleProcessor() {}

//omitted code for clarity

  public void handleEvent(DataEvent typedEvent) {
    //Default, no filter methods
    dataEventHandler_1.handleEvent(typedEvent);
    pipelineNode_3.update();
    //event stack unwind callbacks
    afterEvent();
  }

}

```

The graphical representation of this execution graph is generated by Fluxtion ESC:

![execution graph for a simple pipeline system](../../.gitbook/assets/sampleprocessor.png)

